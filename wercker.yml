box: golang:1.11

services:
  - id: mysql
    env:
      MYSQL_ROOT_PASSWORD: "password123"
      MYSQL_DATABASE: "test"
  - id: rabbitmq:3-management
    env:
      RABBITMQ_ERLANG_COOKIE: "SWQOKODSQALRPCLNMEQG"
      RABBITMQ_DEFAULT_USER: "guest"
      RABBITMQ_DEFAULT_PASS: "guest"
      RABBITMQ_DEFAULT_VHOST: "/"

build:
  steps:

    - setup-go-workspace
    - script:
        name: go get
        code: |
          go get

    - script:
        name: go build
        code: |
          go build ./...

    - script:
        name: go test
        code: |
          go test ./...

